-- Audit table
CREATE TABLE Salary_Audit (
  AuditID NUMBER PRIMARY KEY,
  EmpID NUMBER,
  OldSalary NUMBER,
  NewSalary NUMBER,
  ChangedOn DATE,
  ChangedBy VARCHAR2(50)
);

-- Sequence for audit id
CREATE SEQUENCE seq_audit START WITH 1 INCREMENT BY 1;

-- Trigger (AFTER UPDATE)
CREATE OR REPLACE TRIGGER trg_salary_audit
AFTER UPDATE OF Salary ON Employee
FOR EACH ROW
BEGIN
  INSERT INTO Salary_Audit(AuditID, EmpID, OldSalary, NewSalary, ChangedOn, ChangedBy)
  VALUES (seq_audit.NEXTVAL, :OLD.EmpID, :OLD.Salary, :NEW.Salary, SYSDATE, USER);
END;
/

-- Test update
UPDATE Employee SET Salary = Salary + 2000 WHERE EmpID = 101;
COMMIT;

SELECT * FROM Salary_Audit;
